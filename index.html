<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Boom Heroes</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body, html { width: 100%; height: 100%; font-family: Arial, sans-serif; background: #222; overflow: hidden; }
    canvas { display: block; background: none; margin: auto; position: absolute; top: 0; bottom: 0; left: 0; right: 0; border: 5px solid #fff; }
    #ui { position: absolute; top: 10px; left: 10px; color: white; font-size: 18px; z-index: 10; }
    #gameOver {
      display: none;
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      color: red;
      font-size: 36px;
      background: rgba(0, 0, 0, 0.7);
      padding: 20px;
      border: 2px solid white;
      text-align: center;
      width: 400px;
      font-family: 'Arial Black', sans-serif;
      z-index: 20;
    }
  </style>
</head>
<body>
  <div id="ui">Boom Heroes - 1–4 für Helden, Pfeile bewegen, Leertaste = Spezial, F für Schießen</div>
  <div id="gameOver"></div>
  <canvas id="gameCanvas" width="800" height="600"></canvas>
  <audio id="bgMusic" loop autoplay>
    <source src="https://cdn.pixabay.com/download/audio/2022/10/19/audio_78335c9c96.mp3?filename=battle-theme-ambient-122949.mp3" type="audio/mpeg" />
  </audio>
<script>
  const canvas = document.getElementById("gameCanvas");
  const ctx = canvas.getContext("2d");
  const gameOverScreen = document.getElementById("gameOver");

  const music = document.getElementById("bgMusic");
  music.volume = 0.3;

  const sfxShoot = new Audio("https://cdn.pixabay.com/download/audio/2022/03/22/audio_d98f38fd7a.mp3?filename=retro-game-powerup-21369.mp3");
  const sfxHit = new Audio("https://cdn.pixabay.com/download/audio/2022/03/22/audio_f3b7dbaeb0.mp3?filename=retro-game-impact-24975.mp3");

  // Charaktere
  const characters = {
    "Max Blaze": { x: 150, y: 300, color: "red", ability: "Punch", hp: 100, alive: true },
    "Torchbot": { x: 150, y: 360, color: "orange", ability: "Flame", hp: 100, alive: true },
    "Volt Girl": { x: 150, y: 420, color: "purple", ability: "Dash", hp: 100, alive: true },
    "Boomimp": { x: 150, y: 480, color: "green", ability: "Boom", hp: 100, alive: true }
  };

  let selected = "Max Blaze";
  let specialActive = false;
  let specialTimer = 0;

  // Raumschiffe links, 4 Stück, je 1000 hp, schützen die Charaktere
  const spaceships = [
    { x: 50, y: 280, width: 70, height: 70, hp: 1000 },
    { x: 50, y: 340, width: 70, height: 70, hp: 1000 },
    { x: 50, y: 400, width: 70, height: 70, hp: 1000 },
    { x: 50, y: 460, width: 70, height: 70, hp: 1000 }
  ];

  const enemies = [];
  const effects = [];
  const powerups = [];
  const bullets = [];

  let isGameOver = false;

  // Gegner spawnen
  function spawnEnemy() {
    if (!isGameOver) {
      enemies.push({
        x: 800,
        y: Math.random() * 550 + 25,
        radius: 20,
        speed: 1 + Math.random() * 1,
        hp: Math.floor(Math.random() * 3) + 1, // braucht 1-3 Schüsse
        dying: false,
        dyingFrame: 0
      });
    }
  }

  function spawnPowerup() {
    if (!isGameOver) {
      powerups.push({ x: Math.random() * 700 + 50, y: Math.random() * 500 + 50, radius: 10 });
    }
  }

  setInterval(spawnEnemy, 2500);
  setInterval(spawnPowerup, 8000);

  document.addEventListener("keydown", e => {
    if (isGameOver) return;
    const char = characters[selected];
    if (!char.alive) return;

    if (e.key === "ArrowRight") {
      if (char.x + 10 < 700) char.x += 10;
    }
    if (e.key === "ArrowLeft") {
      if (char.x - 10 > 150) char.x -= 10; // nicht in Raumschiffe reinlaufen
    }
    if (e.key === "ArrowUp") {
      if (char.y - 10 > 50) char.y -= 10;
    }
    if (e.key === "ArrowDown") {
      if (char.y + 10 < 550) char.y += 10;
    }
    if (e.key === "1") selected = "Max Blaze";
    if (e.key === "2") selected = "Torchbot";
    if (e.key === "3") selected = "Volt Girl";
    if (e.key === "4") selected = "Boomimp";
    if (e.key === " ") activateSpecial();
    if (e.key.toLowerCase() === "f") shootBullet();
  });

  // Bilder laden
  const images = {
    "Max Blaze": new Image(),
    "Torchbot": new Image(),
    "Volt Girl": new Image(),
    "Boomimp": new Image(),
    "enemy": new Image(),
    "background": new Image(),
    "spaceship": new Image()
  };

  images["background"].src = "IMG_4485.png";
  images["Max Blaze"].src = "Max_blaze.png";
  images["Torchbot"].src = "Torchbot.png";
  images["Volt Girl"].src = "Volt_girl.png";
  images["Boomimp"].src = "Boomimp.png";
  images["enemy"].src = "meteor_enemy.png";
  images["spaceship"].src = "spaceship.png";

  function drawCharacter(name, char) {
    if (!char.alive) return;
    const img = images[name];
    ctx.drawImage(img, char.x - 25, char.y - 25, 50, 50);
    ctx.fillStyle = "white";
    ctx.font = "16px Arial";
    ctx.fillText(name, char.x - 25, char.y - 35);
    ctx.fillText(`HP: ${char.hp}`, char.x - 25, char.y + 40);
  }

  function drawSpaceship(ship) {
    if (ship.hp <= 0) return;
    ctx.drawImage(images["spaceship"], ship.x - ship.width/2, ship.y - ship.height/2, ship.width, ship.height);
    ctx.fillStyle = "white";
    ctx.font = "14px Arial";
    ctx.fillText(`HP: ${ship.hp}`, ship.x - 30, ship.y + 50);
  }

  function activateSpecial() {
    const char = characters[selected];
    if (!char.alive) return;
    specialActive = true;
    specialTimer = 20;
    effects.push({ x: char.x, y: char.y, type: char.ability, time: 20 });
    sfxShoot.play();
  }

  function shootBullet() {
    const char = characters[selected];
    if (!char.alive) return;
    bullets.push({
      x: char.x + 20,
      y: char.y,
      radius: 5,
      speed: 7
    });
    sfxShoot.play();
  }

  function drawEnemy(enemy) {
    if (enemy.dying) {
      ctx.fillStyle = `rgba(255, ${Math.floor(255 - enemy.dyingFrame * 25)}, 0, 0.7)`;
      ctx.beginPath();
      ctx.arc(enemy.x, enemy.y, 20 + enemy.dyingFrame * 3, 0, Math.PI * 2);
      ctx.fill();
      enemy.dyingFrame++;
      if (enemy.dyingFrame > 10) {
        const index = enemies.indexOf(enemy);
        if (index > -1) enemies.splice(index, 1);
      }
      return;
    }
    ctx.drawImage(images["enemy"], enemy.x - 25, enemy.y - 25, 50, 50);
  }

  function drawPowerup(p) {
    ctx.fillStyle = "gold";
    ctx.beginPath();
    ctx.arc(p.x, p.y, p.radius, 0, Math.PI * 2);
    ctx.fill();
  }

  function updateEffects() {
    for (let i = effects.length - 1; i >= 0; i--) {
      const eff = effects[i];
      eff.time--;
      ctx.strokeStyle = "white";
      ctx.beginPath();
      if (eff.type === "Punch") {
        ctx.arc(eff.x, eff.y, 50, 0, Math.PI * 2);
      } else if (eff.type === "Flame") {
        ctx.rect(eff.x, eff.y - 10,
